# 移动端体验分析报告

## 1. 问题背景
项目目前的交互设计主要针对桌面端鼠标操作，依赖 `hover`（悬停）来展示预览信息，`click`（点击）来进行页面跳转。
在触屏设备（手机/平板）上，由于没有物理鼠标悬停状态，浏览器的默认行为通常是：
- 第一次点击：触发 `:hover` 样式和 `mouseover` 事件（显示预览信息）。
- 第二次点击（或第一次点击的同时，取决于具体实现）：触发 `click` 事件（跳转）。

用户反馈体验较差，可能是因为：
1.  **操作不一致**：有时点击直接跳转，导致无法看到预览信息；有时需要点击两次，操作繁琐。
2.  **样式残留**：点击后的 `:hover` 样式（如背景变色、放大）会一直保留，直到点击其他区域。
3.  **误触**：想要查看信息时不小心触发了跳转。

## 2. 现状分析

### 2.1 地图图标 (`drawMapIcons.js` & `workIcon.css`)
- **交互逻辑**：
    - `mouseover`: 显示 `descriptionBox`（简介）和 `hoverContent`（预览图）。
    - `mouseleave`: 隐藏上述内容。
    - `click`: 直接跳转到 `template.html`。
    - CSS `:hover`: 图标放大 (`scale(1.2)`), 层级提高 (`z-index: 9999`)。
- **手机端问题**：
    - 用户点击图标时，可能会瞬间触发 `mouseover` 然后立即触发 `click`，导致直接跳转，用户根本来不及看简介。
    - 或者，如果浏览器拦截了首次点击用于触发 `:hover`，用户则需要点击两次才能跳转，且第一次点击弹出的浮层可能会遮挡视线或位置尴尬。

### 2.2 导航栏 (`navigater.css`)
- **交互逻辑**：
    - CSS `:hover`: 改变背景色 (`background`) 和模糊效果 (`backdrop-filter`)。
- **手机端问题**：
    - 点击按钮后，按钮会保持 "hover" 状态（背景变色），直到用户点击屏幕其他地方。这在视觉上会造成困惑，感觉按钮被“选中”了。

### 2.3 筛选标签 (`filterManager.js`)
- **现状**：已经包含了 `isTouchDevice` 检测。
- **处理**：监听 `touchstart` 和 `touchend`，手动管理 `touch-active` 类，并在 `touchend` 后移除，模拟点击反馈。
- **启示**：这部分逻辑是比较好的参考，应该推广到其他组件。

## 3. 改进方案

### 3.1 全局 CSS 优化
- 使用 Media Query `@media (hover: hover)` 包裹所有的 `:hover` 样式。这样触屏设备就不会应用 hover 样式，避免样式残留问题。
- 为触屏设备添加 `:active` 或 `.active` 样式，提供按压反馈。

### 3.2 地图图标交互优化 (核心)
建议采用 **“一次点击预览，二次点击跳转”** 的模式（或类似逻辑）：
1.  **引入状态**：记录当前被“选中”（激活）的图标 ID。
2.  **点击逻辑**：
    - 如果点击的图标 **不是** 当前选中图标：
        - 阻止跳转。
        - 将其设为选中状态。
        - 手动触发“显示预览信息”的逻辑（复用 `mouseover` 的逻辑）。
    - 如果点击的图标 **是** 当前选中图标：
        - 允许跳转（执行 `click` 跳转逻辑）。
3.  **点击空白处**：
    - 清除选中状态，隐藏预览信息。

### 3.3 导航栏优化
- 移除手机端的 `:hover` 背景变化。
- 添加 `touchstart` / `touchend` 事件或 `:active` 伪类，在手指按下时改变背景，抬起时恢复，提供即时的点击反馈。

## 4. 实施计划
1.  **修改 CSS**：查找所有 `:hover`，用 `@media (hover: hover)` 包裹。
2.  **修改 `drawMapIcons.js`**：
    - 添加 `isTouchDevice` 检测（或复用）。
    - 改造 `click` 事件监听器，实现“点击预览，再次点击跳转”的逻辑。
    - 添加全局点击监听，用于点击空白处取消预览。
3.  **验证**：在模拟器或真机上测试交互流程。
